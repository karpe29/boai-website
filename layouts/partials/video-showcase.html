<section class="relative min-h-screen bg-primary py-16">
    <!-- Background gradient overlay -->
    <div class="absolute inset-0 bg-gradient-to-br from-primary via-primary-dark to-primary opacity-90"></div>
    
    <div class="container mx-auto px-6 relative z-10">
        <div class="max-w-7xl mx-auto">
            <!-- Title Section -->
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-4" style="font-family: 'Georgia', 'Times New Roman', 'Palatino', 'Book Antiqua', serif;">
                    Work We've Shipped
                </h1>
                <p class="text-lg md:text-xl text-[#d8d8dc]/80 font-light max-w-3xl mx-auto" style="font-family: 'Poppins', sans-serif;">
                    Video ads optimized for persona, platform, and performance
                </p>
            </div>
            
            <!-- Filter Section -->
            <div class="video-filter-section mb-8">
                <div class="video-category-filter flex flex-wrap items-center gap-2">
                    <!-- Video filter buttons will be dynamically generated -->
                </div>
                <div class="video-industry-filter flex flex-wrap items-center gap-2 mt-2">
                    <!-- Industry filter buttons will be dynamically generated -->
                </div>
            </div>
            
            <!-- Mosaic Grid Container -->
            <div id="video-mosaic-grid" class="video-mosaic-container">
                <!-- Videos will be dynamically inserted here -->
            </div>
        </div>
    </div>
</section>

<!-- Video Lightbox Modal -->
<div id="video-lightbox" class="video-lightbox" style="display: none;">
    <div class="video-lightbox-overlay"></div>
    <div class="video-lightbox-content">
        <button class="video-lightbox-close" aria-label="Close video">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>
        <div class="video-lightbox-player">
            <video id="lightbox-video" class="w-full h-full" controls autoplay>
                <source id="lightbox-video-source" src="" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
        <div class="video-lightbox-title">
            <p id="lightbox-video-title" class="text-white text-lg font-medium"></p>
        </div>
    </div>
</div>

<script>
// Global state
let allVideos = [];
let currentFilter = 'all'; // Can be 'all', category, or industry
let currentFilterType = 'all'; // 'all', 'category', or 'industry'

document.addEventListener('DOMContentLoaded', function() {
    // Get filter from URL parameter
    const urlParams = new URLSearchParams(window.location.search);
    const filterFromUrl = urlParams.get('filter');
    const filterTypeFromUrl = urlParams.get('type');
    if (filterFromUrl && filterTypeFromUrl) {
        currentFilter = filterFromUrl;
        currentFilterType = filterTypeFromUrl;
    }
    
    // Initialize videos and grid (filters will be set up inside setupVideoGrid)
    setupVideoGrid();
    
    // Handle window resize
    let resizeTimer;
    window.addEventListener('resize', () => {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => {
            // Reload layout on resize
            setupVideoGrid();
        }, 250);
    });
    
    // Handle browser back/forward buttons
    window.addEventListener('popstate', function(event) {
        const urlParams = new URLSearchParams(window.location.search);
        const filterFromUrl = urlParams.get('filter') || 'all';
        const filterTypeFromUrl = urlParams.get('type') || 'all';
        if (filterFromUrl !== currentFilter || filterTypeFromUrl !== currentFilterType) {
            currentFilter = filterFromUrl;
            currentFilterType = filterTypeFromUrl;
            setupCategoryFilters();
            setupVideoGrid();
        }
    });
});

function setupCategoryFilters() {
    const categoryFilterContainer = document.querySelector('.video-category-filter');
    const industryFilterContainer = document.querySelector('.video-industry-filter');
    if (!categoryFilterContainer || !industryFilterContainer || allVideos.length === 0) return;
    
    // Get all unique categories from videos
    const categories = [...new Set(allVideos.map(v => v.category).filter(Boolean))];
    const categoryNames = {
        'supers': 'Supers',
        'vo': 'VO',
        'character': 'Character',
        'product': 'Product',
        'lipsync': 'Lipsync',
        'pdftovideo': 'PDF to Video'
    };
    
    // Get all unique industries from videos
    const industries = [...new Set(allVideos.map(v => v.industry).filter(Boolean))];
    const industryNames = {
        'fashion': 'Fashion',
        'hospitality': 'Hospitality',
        'healthcare': 'Healthcare',
        'bfsi': 'BFSI',
        'jewellery': 'Jewellery',
        'education': 'Education'
    };
    
    // Generate video filter HTML (first line)
    let categoryFilterHTML = '';
    
    // All Videos button
    const isAllActive = currentFilter === 'all' ? 'active' : '';
    categoryFilterHTML += `<button class="category-filter-btn ${isAllActive}" data-filter="all" data-type="all">All Videos</button>`;
    
    // Category filters
    categories.forEach(category => {
        const displayName = categoryNames[category] || category.charAt(0).toUpperCase() + category.slice(1).replace(/-/g, ' ');
        const isActive = currentFilter === category && currentFilterType === 'category' ? 'active' : '';
        categoryFilterHTML += `<button class="category-filter-btn ${isActive}" data-filter="${category}" data-type="category">${displayName}</button>`;
    });
    
    categoryFilterContainer.innerHTML = categoryFilterHTML;
    
    // Generate industry filter HTML (second line)
    let industryFilterHTML = '';
    
    // Industry filters
    industries.forEach(industry => {
        const displayName = industryNames[industry] || industry.charAt(0).toUpperCase() + industry.slice(1);
        const isActive = currentFilter === industry && currentFilterType === 'industry' ? 'active' : '';
        industryFilterHTML += `<button class="category-filter-btn ${isActive}" data-filter="${industry}" data-type="industry">${displayName}</button>`;
    });
    
    industryFilterContainer.innerHTML = industryFilterHTML;
    
    // Add click handlers to both containers
    const allFilterButtons = categoryFilterContainer.querySelectorAll('.category-filter-btn');
    const industryFilterButtons = industryFilterContainer.querySelectorAll('.category-filter-btn');
    
    [...allFilterButtons, ...industryFilterButtons].forEach(btn => {
        btn.addEventListener('click', function() {
            const filter = this.getAttribute('data-filter');
            const type = this.getAttribute('data-type');
            setFilter(filter, type);
        });
    });
}

function setFilter(filter, type) {
    currentFilter = filter;
    currentFilterType = type;
    
    // Update URL without page reload
    const url = new URL(window.location);
    if (filter === 'all') {
        url.searchParams.delete('filter');
        url.searchParams.delete('type');
    } else {
        url.searchParams.set('filter', filter);
        url.searchParams.set('type', type);
    }
    window.history.pushState({ filter, type }, '', url);
    
    // Update active button - only one can be active at a time (across both containers)
    const categoryContainer = document.querySelector('.video-category-filter');
    const industryContainer = document.querySelector('.video-industry-filter');
    
    // Update category filter buttons
    if (categoryContainer) {
        categoryContainer.querySelectorAll('.category-filter-btn').forEach(btn => {
            const btnFilter = btn.getAttribute('data-filter');
            const btnType = btn.getAttribute('data-type');
            if (btnFilter === filter && btnType === type) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });
    }
    
    // Update industry filter buttons
    if (industryContainer) {
        industryContainer.querySelectorAll('.category-filter-btn').forEach(btn => {
            const btnFilter = btn.getAttribute('data-filter');
            const btnType = btn.getAttribute('data-type');
            if (btnFilter === filter && btnType === type) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });
    }
    
    // Reload grid with filtered videos
    createMosaicGrid();
}

function setupVideoGrid() {
    createMosaicGrid();
    // Setup filters after videos are initialized
    if (allVideos.length > 0) {
        setupCategoryFilters();
    }
}

// Function to load video metadata and get dimensions
async function loadVideoDimensions(video) {
    return new Promise((resolve) => {
        // If aspect ratio already loaded, return it
        if (video.aspectRatio) {
            resolve(video.aspectRatio);
            return;
        }
        
        const videoEl = document.createElement('video');
        videoEl.preload = 'metadata';
        videoEl.src = video.src;
        
        videoEl.addEventListener('loadedmetadata', () => {
            const aspectRatio = videoEl.videoWidth / videoEl.videoHeight;
            video.aspectRatio = aspectRatio;
            video.width = videoEl.videoWidth;
            video.height = videoEl.videoHeight;
            resolve(aspectRatio);
        });
        
        videoEl.addEventListener('error', () => {
            // Fallback to 16:9 if video fails to load
            video.aspectRatio = 16/9;
            resolve(16/9);
        });
    });
}

// Function to load all video dimensions
async function loadAllVideoDimensions(videos) {
    const promises = videos.map(video => loadVideoDimensions(video));
    await Promise.all(promises);
}

function createMosaicGrid() {
    // ============================================
    // CONFIGURATION: Change this to adjust row height
    // ============================================
    const TARGET_ROW_HEIGHT = 350; // Change this value to set all row heights
    // ============================================
    
    const container = document.getElementById('video-mosaic-grid');
    
    // Initialize all videos with categories (only on first load)
    // GCP Cloud Storage public bucket - direct serve (no CDN)
    const GCP_BUCKET_BASE_URL = "https://storage.googleapis.com/blinkofai-portfolio-videos-20260114/";
    
    if (allVideos.length === 0) {
        allVideos = [
            { 
                src: GCP_BUCKET_BASE_URL + "CANCUN/Cancun%20Pre%20Reg.mp4", 
                title: "OYO Cancun", 
                category: "supers",
                industry: "hospitality",
                tags: ["Supers", "Brand Visuals", "AI enhanced", "On-Brand"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "PrimeBook/Primebook_video.mp4", 
                title: "Primebook", 
                category: "supers",
                industry: "eCommerce",
                tags: ["Supers", "Brand Visuals", "AI Animation", "On-Brand"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "EMT/Final_1_v5_Vo.mp4", 
                title: "EMT", 
                category: "vo",
                industry: "hospitality",
                tags: ["Supers", "VO", "AI Visuals", "On-Brand"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "OYO%20BELVILLA/English%20V3.mp4", 
                title: "OYO Belville", 
                category: "vo",
                industry: "hospitality",
                tags: ["Supers", "VO", "Brand Visuals", "On-Brand"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "ABSLI/ABSLI_v2.mp4", 
                title: "ABSLI Farhan Akhtar", 
                category: "vo",
                industry: "bfsi",
                tags: ["Supers", "VO", "Brand Visuals", "On-Brand"]
            },
            // { 
            //     src: GCP_BUCKET_BASE_URL + "HDFC/HDFC%202.mp4", 
            //     title: "HDFC ETF", 
            //     category: "vo",
            //     industry: "bfsi",
            //     tags: ["Supers", "VO", "Stock", "AI Animation", "On-Brand"]
            // },
            { 
                src: GCP_BUCKET_BASE_URL + "ICICI/ICICI_Video_2_New_v3.mp4", 
                title: "ICICI Orange Book", 
                category: "character",
                industry: "bfsi",
                tags: ["Supers", "VO", "Brand Visuals", "AI Animation", "On-Brand"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "Indira%20IVF/IVF_new%20year_v5.mp4", 
                title: "Indira IVF New Years", 
                category: "character",
                industry: "healthcare",
                tags: ["Supers", "VO", "AI Visuals", "On-Brand"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "Kotak/Script6_Kotak_v6.mp4", 
                title: "Kotak Script 6", 
                category: "character",
                industry: "bfsi",
                tags: ["Supers", "VO", "Stock", "AI Visuals", "AI Animation", "On-Brand"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "SCALER/Scaler_Master_Script%204.mp4", 
                title: "Scaler", 
                category: "character",
                industry: "education",
                tags: ["Supers", "VO", "AI Avatar", "On-Brand"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "Coggi/Coggi_video_v7.mp4", 
                title: "Coggi", 
                category: "character",
                industry: "education",
                tags: ["Supers", "VO", "Brand Visuals", "AI Visuals", "AI Animation", "On-Brand"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "Paragon/Eeken%20EVA%20shoes_v9.mp4", 
                title: "Paragon Eeken", 
                category: "product",
                industry: "fashion",
                tags: ["Supers", "VO", "Product Accuracy"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "Urban%20Money/UrbanMoney_Cap_v5.mp4", 
                title: "Urban Monkey", 
                category: "product",
                industry: "fashion",
                tags: ["Supers", "Product Accuracy", "AI Animation", "AI Visuals", "On-Brand"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "JPEARLS%20EARRINGS/Jpearls%20Earrings.mp4", 
                title: "JPearls Earrings", 
                category: "product",
                industry: "jewellery",
                tags: ["Supers", "VO", "Product Accuracy", "AI Visuals", "On-Brand"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "OYO%20Traum/Traum%20English%2016x9.mp4", 
                title: "Traum", 
                category: "character",
                industry: "hospitality",
                tags: ["Supers", "VO", "AI Avatar", "Character Consistency", "Brand Visuals", "On-Brand"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "CANCUN/Cancun%20Post%20Reg.mp4", 
                title: "OYO Cancun Post Reg", 
                category: "supers",
                industry: "hospitality",
                tags: ["Supers"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "OYO%20BELVILLA/DE_Belvilla_6s_16-9.mp4", 
                title: "Belvilla DE", 
                category: "vo",
                industry: "hospitality",
                tags: []
            },
            { 
                src: GCP_BUCKET_BASE_URL + "OYO%20BELVILLA/EnglishMalay%20LW%2010sec%20Square.mp4", 
                title: "English Malay LW", 
                category: "vo",
                industry: "hospitality",
                tags: ["Supers", "VO"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "OYO%20Traum/G6%20App_Night_6%20sec_Square.mp4", 
                title: "G6 App Night", 
                category: "character",
                industry: "hospitality",
                tags: ["Supers", "Character"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "HDFC/HDFC_v7_With_Logos.mp4", 
                title: "HDFC v7", 
                category: "vo",
                industry: "bfsi",
                tags: ["Supers", "VO"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "CANCUN/Indonesia%20Vertical.mp4", 
                title: "Indonesia Vertical", 
                category: "supers",
                industry: "hospitality",
                tags: ["Supers"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "JPEARLS/Jpeals%20Leadership%20Luxe.mp4", 
                title: "Jpearls Leadership Luxe", 
                category: "product",
                industry: "jewellery",
                tags: ["Supers", "Product"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "JPEARLS/Jpearls%20Gifting%201.mp4", 
                title: "Jpearls Gifting", 
                category: "product",
                industry: "jewellery",
                tags: ["Supers", "Product"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "NAIJA/Naija%20Organics%20Sandalwood.mp4", 
                title: "Naija Organics Sandalwood", 
                category: "product",
                industry: "eCommerce",
                tags: ["Supers", "Product"]
            },
            { 
                src: GCP_BUCKET_BASE_URL + "OYO%20Traum/Tamil%209x16.mp4", 
                title: "Tamil Vertical", 
                category: "vo",
                industry: "hospitality",
                tags: ["Supers", "VO"]
            }
        ];
    }
    
    // Filter videos based on current filter (mutually exclusive)
    let videos = allVideos;
    if (currentFilter !== 'all') {
        if (currentFilterType === 'category') {
            videos = allVideos.filter(video => video.category === currentFilter);
        } else if (currentFilterType === 'industry') {
            videos = allVideos.filter(video => video.industry === currentFilter);
        }
    }
    
    // Load video dimensions first, then create grid
    loadAllVideoDimensions(videos).then(() => {
        createGridLayout(videos, container, TARGET_ROW_HEIGHT);
    });
}

function createGridLayout(videos, container, TARGET_ROW_HEIGHT) {
    const gap = 20;
    const containerPadding = 0; // No side padding
    
    // Get container width
    function getContainerWidth() {
        const computedStyle = window.getComputedStyle(container);
        const padding = parseFloat(computedStyle.paddingLeft) + parseFloat(computedStyle.paddingRight);
        return container.offsetWidth - padding || container.parentElement.offsetWidth;
    }
    
    const containerWidth = getContainerWidth();
    const availableWidth = containerWidth; // Full width, no side padding
    
    // Calculate layout using justified layout algorithm with actual video aspect ratios
    const boxes = [];
    let currentRow = [];
    let currentRowWidth = 0;
    let currentTop = 0; // No top padding
    
    videos.forEach((video) => {
        // Use actual video aspect ratio
        const aspectRatio = video.aspectRatio || 16/9; // Fallback to 16:9 if not loaded
        const boxHeight = TARGET_ROW_HEIGHT; // Use fixed row height
        const boxWidth = boxHeight * aspectRatio;
        
        // Check if this box fits in current row
        const neededWidth = boxWidth + (currentRow.length > 0 ? gap : 0);
        
        if (currentRowWidth + neededWidth <= availableWidth || currentRow.length === 0) {
            // Add to current row
            currentRow.push({ width: boxWidth, height: boxHeight, video: video, aspectRatio: aspectRatio });
            currentRowWidth += neededWidth;
        } else {
            // Finalize current row and start new one
            if (currentRow.length > 0) {
                // Scale widths to fit container while maintaining aspect ratios
                const denominator = currentRowWidth - (gap * (currentRow.length - 1));
                const scale = denominator > 0 ? (availableWidth - (gap * (currentRow.length - 1))) / denominator : 1;
                
                let left = 0; // No side padding
                let maxHeight = 0;
                
                // First pass: calculate scaled dimensions and find max height
                currentRow.forEach(box => {
                    const scaledWidth = box.width * scale;
                    const scaledHeight = scaledWidth / box.aspectRatio; // Maintain aspect ratio
                    maxHeight = Math.max(maxHeight, scaledHeight);
                });
                
                // Second pass: create boxes with maintained aspect ratios
                currentRow.forEach(box => {
                    const scaledWidth = box.width * scale;
                    const scaledHeight = scaledWidth / box.aspectRatio; // Maintain aspect ratio
                    boxes.push({
                        left: left,
                        top: currentTop,
                        width: scaledWidth,
                        height: scaledHeight, // Maintain aspect ratio
                        video: box.video
                    });
                    left += scaledWidth + gap;
                });
                
                currentTop += maxHeight + gap; // Use max height for spacing
            }
            
            // Start new row
            currentRow = [{ width: boxWidth, height: boxHeight, video: video, aspectRatio: aspectRatio }];
            currentRowWidth = boxWidth;
        }
    });
    
    // Finalize last row
    if (currentRow.length > 0) {
        // Scale widths to fit container while maintaining aspect ratios
        const denominator = currentRowWidth - (gap * (currentRow.length - 1));
        const scale = denominator > 0 ? (availableWidth - (gap * (currentRow.length - 1))) / denominator : 1;
        
        let left = 0; // No side padding
        let maxHeight = 0;
        
        // First pass: calculate scaled dimensions and find max height
        currentRow.forEach(box => {
            const scaledWidth = box.width * scale;
            const scaledHeight = scaledWidth / box.aspectRatio; // Maintain aspect ratio
            maxHeight = Math.max(maxHeight, scaledHeight);
        });
        
        // Second pass: create boxes with maintained aspect ratios
        currentRow.forEach(box => {
            const scaledWidth = box.width * scale;
            const scaledHeight = scaledWidth / box.aspectRatio; // Maintain aspect ratio
            boxes.push({
                left: left,
                top: currentTop,
                width: scaledWidth,
                height: scaledHeight, // Maintain aspect ratio
                video: box.video
            });
            left += scaledWidth + gap;
        });
        
        currentTop += maxHeight; // Use max height
    }
    
    // Create HTML
    let html = '';
    boxes.forEach((box, index) => {
        html += `
            <div class="video-mosaic-item" 
                 data-video-src="${box.video.src}"
                 data-video-title="${box.video.title}"
                 style="position: absolute; 
                        left: ${box.left}px; 
                        top: ${box.top}px; 
                        width: ${box.width}px; 
                        height: ${box.height}px;
                        border-radius: 12px;
                        overflow: hidden;
                        cursor: pointer;
                        transition: transform 0.3s ease, box-shadow 0.3s ease;">
                <div class="relative w-full h-full bg-primary-dark group">
                    <video 
                        class="w-full h-full object-contain"
                        preload="none"
                        loading="lazy"
                        muted
                        playsinline
                        data-src="${box.video.src}">
                        <source data-src="${box.video.src}" type="video/mp4">
                    </video>
                    <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    
                    <!-- Client Name Badge (top-left) -->
                    <div class="absolute top-3 left-3 z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        <span class="bg-white/10 backdrop-blur-md border border-white/20 text-white px-3 py-1.5 rounded-full text-xs font-semibold">
                            ${box.video.title}
                        </span>
                    </div>
                    
                    <!-- Tags (bottom-left) -->
                    ${box.video.tags && box.video.tags.length > 0 ? `
                    <div class="absolute bottom-3 left-3 z-10 flex flex-wrap items-center gap-1.5 opacity-0 group-hover:opacity-100 transition-opacity duration-300 max-w-[80%]">
                        ${box.video.tags.map(tag => `
                            <div class="flex items-center gap-1 bg-black/40 backdrop-blur-sm px-2.5 py-0.5 rounded-lg border border-white/10">
                                <span class="text-white text-[10px] font-normal">${tag}</span>
                            </div>
                        `).join('')}
                    </div>
                    ` : ''}
                    
                 
                    
                    <!-- Play Button (center) -->
                    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        <div class="bg-white/20 backdrop-blur-md rounded-full p-4">
                            <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M8 5v14l11-7z"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        `;
    });
    
    container.innerHTML = html;
    container.style.height = `${currentTop}px`; // No padding
    container.style.position = 'relative';
    
    // Setup lazy loading and hover effects
    setupVideoInteractions(container);
}


function setupVideoInteractions(container) {
    // Lazy load videos using Intersection Observer
    const videoElements = container.querySelectorAll('video[data-src]');
    const videoObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const video = entry.target;
                const source = video.querySelector('source');
                if (source && source.dataset.src) {
                    source.src = source.dataset.src;
                    video.load();
                    video.addEventListener('loadeddata', () => {
                        video.classList.add('loaded');
                        const item = video.closest('.video-mosaic-item');
                        if (item) {
                            item.style.setProperty('--loading', 'none');
                        }
                    }, { once: true });
                    videoObserver.unobserve(video);
                }
            }
        });
    }, {
        rootMargin: '50px'
    });
    
    videoElements.forEach(video => {
        videoObserver.observe(video);
    });
    
    // Add hover effects
    const items = container.querySelectorAll('.video-mosaic-item');
    items.forEach(item => {
        item.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.05)';
            this.style.zIndex = '10';
            this.style.boxShadow = '0 20px 40px rgba(255, 127, 39, 0.3)';
        });
        
        item.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1)';
            this.style.zIndex = '1';
            this.style.boxShadow = 'none';
        });
        
        const video = item.querySelector('video');
        if (video) {
            item.addEventListener('mouseenter', () => {
                video.play().catch(e => console.log('Autoplay prevented'));
            });
            item.addEventListener('mouseleave', () => {
                video.pause();
            });
            
            // Add click handler to open lightbox
            item.addEventListener('click', () => {
                const videoSrc = item.getAttribute('data-video-src');
                const videoTitle = item.getAttribute('data-video-title');
                openVideoLightbox(videoSrc, videoTitle);
            });
        }
    });
}

function openVideoLightbox(videoSrc, videoTitle) {
    const lightbox = document.getElementById('video-lightbox');
    const lightboxVideo = document.getElementById('lightbox-video');
    const lightboxVideoSource = document.getElementById('lightbox-video-source');
    const lightboxVideoTitle = document.getElementById('lightbox-video-title');
    
    if (!lightbox || !lightboxVideo || !lightboxVideoSource) return;
    
    // Set video source and title
    lightboxVideoSource.src = videoSrc;
    lightboxVideo.load();
    lightboxVideoTitle.textContent = videoTitle || 'Video';
    
    // Show lightbox
    lightbox.style.display = 'block';
    document.body.style.overflow = 'hidden'; // Prevent background scrolling
    
    // Play video with sound (unmuted)
    setTimeout(() => {
        lightboxVideo.muted = false;
        lightboxVideo.play().catch(e => {
            console.log('Autoplay prevented, user interaction required');
        });
    }, 100);
}

function closeVideoLightbox() {
    const lightbox = document.getElementById('video-lightbox');
    const lightboxVideo = document.getElementById('lightbox-video');
    
    if (!lightbox || !lightboxVideo) return;
    
    // Pause and reset video
    lightboxVideo.pause();
    lightboxVideo.currentTime = 0;
    lightboxVideo.muted = true; // Reset to muted
    
    // Hide lightbox
    lightbox.style.display = 'none';
    document.body.style.overflow = ''; // Restore scrolling
}

// Initialize lightbox event listeners
document.addEventListener('DOMContentLoaded', function() {
    const lightbox = document.getElementById('video-lightbox');
    const closeButton = document.querySelector('.video-lightbox-close');
    const overlay = document.querySelector('.video-lightbox-overlay');
    
    if (closeButton) {
        closeButton.addEventListener('click', closeVideoLightbox);
    }
    
    if (overlay) {
        overlay.addEventListener('click', closeVideoLightbox);
    }
    
    // Close on ESC key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && lightbox && lightbox.style.display === 'block') {
            closeVideoLightbox();
        }
    });
});
</script>

<style>
/* Filter Section Styles */
.video-filter-section {
    margin-bottom: 2rem;
}

.video-category-filter,
.video-industry-filter {
    margin-bottom: 0;
    justify-content: center; /* Center align */
    align-items: center;
}

.category-filter-btn {
    padding: 0.35rem 0.75rem; /* Even smaller */
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
    border-radius: 16px; /* Smaller border radius */
    font-size: 0.75rem; /* Smaller font */
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    font-family: 'Poppins', sans-serif;
    white-space: nowrap;
}

.category-filter-btn:hover {
    background: rgba(255, 127, 39, 0.3);
    border-color: rgba(255, 127, 39, 0.6);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(255, 127, 39, 0.2);
}

.category-filter-btn.active {
    background: rgba(255, 127, 39, 0.8);
    border-color: rgba(255, 127, 39, 1);
    color: white;
    box-shadow: 0 2px 12px rgba(255, 127, 39, 0.4);
}

.category-filter-btn.active:hover {
    background: rgba(255, 127, 39, 0.9);
    transform: translateY(-1px);
    box-shadow: 0 4px 16px rgba(255, 127, 39, 0.5);
}

/* Vertical divider */
.filter-divider {
    width: 1px;
    height: 18px;
    background: rgba(255, 255, 255, 0.3);
    margin: 0 0.4rem;
    flex-shrink: 0;
}

@media (max-width: 768px) {
    .category-filter-btn {
        padding: 0.3rem 0.6rem;
        font-size: 0.7rem;
    }
    
    .video-category-filter {
        gap: 0.3rem;
    }
    
    .filter-divider {
        height: 16px;
        margin: 0 0.25rem;
    }
}

.video-mosaic-container {
    position: relative;
    width: 100%;
    min-height: 400px;
}

.video-mosaic-item {
    border: 2px solid rgba(255, 255, 255, 0.1);
    background: #1a1a1a;
}

.video-mosaic-item:hover {
    border-color: rgba(255, 127, 39, 0.5);
}

.video-mosaic-item video {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: contain;
    background: #1a1a1a;
}

/* Loading state */
.video-mosaic-item::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, #2c2c2c 25%, #3a3a3a 50%, #2c2c2c 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
    z-index: 1;
    pointer-events: none;
}

.video-mosaic-item:has(video.loaded)::before {
    display: none;
    animation: none;
}

@keyframes loading {
    0% {
        background-position: 200% 0;
    }
    100% {
        background-position: -200% 0;
    }
}

/* Video Lightbox Styles */
.video-lightbox {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.3s ease;
}

.video-lightbox-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(10px);
}

.video-lightbox-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10000;
    width: 90%;
    max-width: 1200px;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    animation: slideUp 0.3s ease;
}

.video-lightbox-close {
    position: absolute;
    top: -50px;
    right: 0;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.2);
    color: white;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    z-index: 10001;
}

.video-lightbox-close:hover {
    background: rgba(255, 127, 39, 0.8);
    border-color: rgba(255, 127, 39, 1);
    transform: scale(1.1);
}

.video-lightbox-player {
    width: 100%;
    background: #1a1a1a;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    border: 2px solid rgba(255, 255, 255, 0.1);
}

.video-lightbox-player video {
    width: 100%;
    height: auto;
    display: block;
    max-height: 80vh;
}

.video-lightbox-title {
    margin-top: 20px;
    text-align: center;
    padding: 0 20px;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes slideUp {
    from {
        transform: translate(-50%, calc(-50% + 30px));
        opacity: 0;
    }
    to {
        transform: translate(-50%, -50%);
        opacity: 1;
    }
}

/* Mobile responsive */
@media (max-width: 768px) {
    .video-lightbox-content {
        width: 95%;
        max-height: 85vh;
    }
    
    .video-lightbox-close {
        top: -40px;
        width: 36px;
        height: 36px;
    }
    
    .video-lightbox-player video {
        max-height: 70vh;
    }
}

</style>
